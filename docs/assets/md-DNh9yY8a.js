import{_ as d,I as g}from"./slidev/two-cols-header-C6aDhd79.js";import{b as A,o as y,w as l,g as i,B as s,e as h,m as k,v as D,x as o,C as e}from"./modules/vue-CN_MgJgD.js";import{u as B,f as E}from"./slidev/context-B-YQuNRk.js";import"./modules/unplugin-icons-DEQuOA20.js";import"./index-Dz5oMehX.js";import"./modules/shiki-CbJNJzfY.js";const x={__name:"thread_local.md__slidev_19",setup(c){const{$clicksContext:n,$frontmatter:r}=B();return n.setup(),(C,a)=>{const t=d;return y(),A(g,D(o(e(E)(e(r),18))),{left:l(p=>[h(t,k({},{ranges:[]}),{default:l(()=>a[0]||(a[0]=[i("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light slidev-code",style:{"--shiki-dark":"#dbd7caee","--shiki-light":"#393a34","--shiki-dark-bg":"#121212","--shiki-light-bg":"#ffffff"}},[i("code",{class:"language-cpp"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"int"),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," getInitValue"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"();")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"const"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}}," int"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," InvalidValue "),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"="),i("span",{style:{"--shiki-dark":"#4C9A91","--shiki-light":"#2F798A"}}," 0"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},";")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"__attribute(("),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"tls_model"),i("span",{style:{"--shiki-dark":"#B8A965","--shiki-light":"#998418"}},"("),i("span",{style:{"--shiki-dark":"#C98A7D77","--shiki-light":"#B5695977"}},'"'),i("span",{style:{"--shiki-dark":"#C98A7D","--shiki-light":"#B56959"}},"initial-exec"),i("span",{style:{"--shiki-dark":"#C98A7D77","--shiki-light":"#B5695977"}},'"'),i("span",{style:{"--shiki-dark":"#B8A965","--shiki-light":"#998418"}},")"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"))"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"thread_local"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}}," int"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," value_tl "),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"="),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," InvalidValue"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},";")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"int"),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," getValueTLCustomInit"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"(){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"  if"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}}," ("),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"value_tl "),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"=="),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," InvalidValue"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},")"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}}," {"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"    value_tl "),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"="),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," getInitValue"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"();"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"  return"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," value_tl"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"}")])])],-1)])),_:1},16)]),right:l(p=>[h(t,k({},{ranges:[]}),{default:l(()=>a[1]||(a[1]=[i("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light slidev-code",style:{"--shiki-dark":"#dbd7caee","--shiki-light":"#393a34","--shiki-dark-bg":"#121212","--shiki-light-bg":"#ffffff"}},[i("code",{class:"language-asm"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"getValueTLCustomInit():")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        mov"),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"     rbx"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},", "),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"QWORD"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR value_tl@gottpoff["),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"rip"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"]"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # load offset")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        mov"),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"     eax"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},", "),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"DWORD"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"fs"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},":["),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"rbx"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"]              "),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # load value")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        test"),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"    eax"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},", "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"eax"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"                              # check if it's 0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        je"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"      .CallInitFunc                        "),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # call init if it's 0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        ret")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"."),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"CallInitFunc"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        call"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"    ["),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"QWORD"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR getInitValue()@GOTPCREL["),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"rip"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"]]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        mov"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"     DWORD"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"fs"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},":["),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"rbx"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"], "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"eax")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        ret")])])],-1)])),_:1},16)]),default:l(()=>[a[2]||(a[2]=i("h1",null,"Shared Object : performance workarounds",-1)),a[3]||(a[3]=i("h3",null,[s("WA-3.1 if "),i("code",null,"'initial-exec'"),s(" variable requires dynamic initialization - use a custom one")],-1)),a[4]||(a[4]=i("p",null,[s("Dynamic initialization in this case might call "),i("code",null,"_tls_get_addr"),s(" to check initialization guard that affects performance."),i("br"),s(" If the variable has an invalid state - then the implementation is trivial."),i("br"),s(" if not - add a variable for this purpose: "),i("code",null,"thread_local bool isInitialized = false;"),s(".")],-1))]),_:1},16)}}};export{x as default};
