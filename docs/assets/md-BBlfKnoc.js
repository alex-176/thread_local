import{_ as d,I as A}from"./slidev/two-cols-header-D-5Beytl.js";import{b as g,o as y,w as l,g as i,B as s,e as t,m as k,v as D,x as o,C as n}from"./modules/vue-CN_MgJgD.js";import{u as B,f as c}from"./slidev/context-DAng1aKg.js";import"./modules/unplugin-icons-DEQuOA20.js";import"./index-DlMUDyXS.js";import"./modules/shiki-CbJNJzfY.js";const F={__name:"thread_local.md__slidev_11",setup(C){const{$clicksContext:e,$frontmatter:p}=B();return e.setup(),(E,a)=>{const h=d;return y(),g(A,D(o(n(c)(n(p),10))),{left:l(r=>[t(h,k({},{ranges:[]}),{default:l(()=>a[0]||(a[0]=[i("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light slidev-code",style:{"--shiki-dark":"#dbd7caee","--shiki-light":"#393a34","--shiki-dark-bg":"#121212","--shiki-light-bg":"#ffffff"}},[i("code",{class:"language-cpp"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"int"),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," getpid"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"int"),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," gettid"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"();")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"// 2 thread_local variables with non trivial init")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"thread_local"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}}," int"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," tid "),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"="),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," gettid"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"thread_local"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}}," int"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," pid "),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"="),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," getpid"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"();")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"// pretend we use a variable ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"void"),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," print"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"("),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"int"),i("span",{style:{"--shiki-dark":"#BD976A","--shiki-light":"#B07D48"}}," v"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},");")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"// a function that uses tid")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"void"),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}}," f"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"(){")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"    print"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"("),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"tid"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},"}")])])],-1)])),_:1},16)]),right:l(r=>[t(h,k({},{ranges:[]}),{default:l(()=>a[1]||(a[1]=[i("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light slidev-code",style:{"--shiki-dark":"#dbd7caee","--shiki-light":"#393a34","--shiki-dark-bg":"#121212","--shiki-light-bg":"#ffffff"}},[i("code",{class:"language-asm"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"f():")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        cmp"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"     BYTE"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"fs"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},":__tls_guard@tpoff, "),i("span",{style:{"--shiki-dark":"#4C9A91","--shiki-light":"#2F798A"}},"0"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # Is TLS initialized")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        je"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"      .TLS_Init                  "),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # jmp to TLS Initialization")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"."),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"Continue"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"        ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        mov"),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"     edi"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},", "),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"DWORD"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"fs"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},":tid@tpoff"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # read tid")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        jmp"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"     print("),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"int"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},")                 "),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # call print(tid)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"."),i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"TLS_Init"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"                                  # TLS initialization")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        mov"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"     BYTE"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"fs"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},":__tls_guard@tpoff, "),i("span",{style:{"--shiki-dark":"#4C9A91","--shiki-light":"#2F798A"}},"1"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},' # mark TLS "initialized"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        call"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"    gettid()                    ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        mov"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"     DWORD"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"fs"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},":tid@tpoff, "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"eax"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # init tid with gettid()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        call"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"    getpid()                    ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        mov"),i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"     DWORD"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," PTR "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"fs"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},":pid@tpoff, "),i("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"eax"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}}," # init pid with getpid()  ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#CB7676","--shiki-light":"#AB5959"}},"        jmp"),i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"     .Continue")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"__tls_guard"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"            # Thread Local Storage section")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"        .zero   "),i("span",{style:{"--shiki-dark":"#4C9A91","--shiki-light":"#2F798A"}},"1"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"       # TLS guard - checks if the section initialized")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"pid"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"        .zero   "),i("span",{style:{"--shiki-dark":"#4C9A91","--shiki-light":"#2F798A"}},"4"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"       # thread_local pid")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#80A665","--shiki-light":"#59873A"}},"tid"),i("span",{style:{"--shiki-dark":"#666666","--shiki-light":"#999999"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"        .zero   "),i("span",{style:{"--shiki-dark":"#4C9A91","--shiki-light":"#2F798A"}},"4"),i("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"       # thread_local tid")])])],-1)])),_:1},16)]),default:l(()=>[a[2]||(a[2]=i("h1",null,"Class lifetime : Construction (gcc/clang specific)",-1)),a[3]||(a[3]=i("h4",null,"gcc/clang are using one boolean guard for all thread_local variables",-1)),a[4]||(a[4]=i("h4",null,[s("Implications: if one "),i("code",null,"thread_local"),s(" is accessed - all "),i("code",null,"thread_local"),s(" of this thread are initialized.")],-1))]),_:1},16)}}};export{F as default};
